<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smile Up - Tratamentos</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <img src="logo/logo.png" alt="Smile Up" />
      </div>
      <nav class="menu">
        <a href="dashboard.html" class="active">Dashboard</a>
        <a href="pacientes.html">Pacientes</a>
        <a href="dentistas.html">Dentistas</a>
        <a href="consultas.html">Consultas</a>
        <a href="tratamento.html">Tratamentos</a>
        <a href="pagamentos.html">Financeiro</a>
        <a href="convenios.html">Convênios</a>
        <a href="materiais.html">Materiais</a>
        <a href="relatorios.html">Relatórios</a>
        <a href="#" onclick="logout()" class="danger">Sair</a>
      </nav>
    </aside>

    <main class="content">
      <header class="topbar"><div>Tratamentos</div></header>

      <section class="container">
        <div class="card">
          <h3>Registrar Tratamento</h3>
          <form id="formTratamento" class="form-grid">
            <select id="paciente"></select>
            <select id="dentista"></select>
            <input id="descricao" placeholder="Descrição do tratamento" required />
            <input id="valor" type="number" step="0.01" placeholder="Custo estimado (R$)" />
            <select id="status">
              <option value="Pendente">Pendente</option>
              <option value="Concluído">Concluído</option>
            </select>
            <button class="btn" type="submit">Salvar</button>
          </form>
        </div>

        <div class="card">
          <h3>Lista de Tratamentos</h3>
          <table class="tabela">
            <thead>
              <tr>
                <th>Paciente</th>
                <th>Dentista</th>
                <th>Descrição</th>
                <th>Valor</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="listaTratamentos"></tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <script>
    // --- Dados fixos ---
    const pacientes = [
      { nome: "João Silva", cpf: "123.456.789-10" },
      { nome: "Maria Oliveira", cpf: "987.654.321-00" },
      { nome: "Carlos Pereira", cpf: "111.222.333-44" }
    ];

    const dentistas = [
      { nome: "Dra. Fernanda Costa", cro: "CRO-SP 12345" },
      { nome: "Dr. Pedro Santos", cro: "CRO-SP 67890" },
      { nome: "Dra. Luiza Martins", cro: "CRO-SP 54321" }
    ];

    const tratamentos = [
      {
        paciente: "João Silva",
        dentista: "Dra. Fernanda Costa",
        descricao: "Limpeza e profilaxia",
        valor: 200,
        status: "Concluído"
      },
      {
        paciente: "Maria Oliveira",
        dentista: "Dr. Pedro Santos",
        descricao: "Extração do siso",
        valor: 500,
        status: "Pendente"
      },
      {
        paciente: "Carlos Pereira",
        dentista: "Dra. Luiza Martins",
        descricao: "Canal do molar",
        valor: 850,
        status: "Concluído"
      }
    ];

    // --- Inicialização ---
    document.addEventListener("DOMContentLoaded", () => {
      preencherSelects();
      carregarTratamentos();

      document
        .getElementById("formTratamento")
        .addEventListener("submit", salvarTratamento);
    });

    // --- Preenche selects ---
    function preencherSelects() {
      const selPac = document.getElementById("paciente");
      const selDen = document.getElementById("dentista");

      selPac.innerHTML = pacientes
        .map((p) => `<option value="${p.nome}">${p.nome}</option>`)
        .join("");

      selDen.innerHTML = dentistas
        .map((d) => `<option value="${d.nome}">${d.nome}</option>`)
        .join("");
    }

    // --- Mostra tabela ---
    function carregarTratamentos() {
      const tbody = document.getElementById("listaTratamentos");
      tbody.innerHTML = "";

      tratamentos.forEach((t) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${t.paciente}</td>
          <td>${t.dentista}</td>
          <td>${t.descricao}</td>
          <td>${formatarMoeda(t.valor)}</td>
          <td>${t.status}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // --- Salvar novo ---
    function salvarTratamento(e) {
      e.preventDefault();

      const novo = {
        paciente: document.getElementById("paciente").value,
        dentista: document.getElementById("dentista").value,
        descricao: document.getElementById("descricao").value,
        valor: parseFloat(document.getElementById("valor").value) || 0,
        status: document.getElementById("status").value
      };

      tratamentos.push(novo);
      carregarTratamentos();
      e.target.reset();
    }

    // --- Formatar moeda ---
    function formatarMoeda(valor) {
      return valor.toLocaleString("pt-BR", {
        style: "currency",
        currency: "BRL"
      });
    }

    // --- Logout (fake) ---
    function logout() {
      alert("Sessão encerrada!");
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
